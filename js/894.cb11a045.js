(self["webpackChunkbamxx"]=self["webpackChunkbamxx"]||[]).push([[894],{2894:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>qe});var r=t(3673);const d={class:"staff__button row justify-center q-px-xl q-py-md"},l={class:"container q-py-xl"},a={class:"row q-px-xl"};function i(e,s,t,i,o,n){const u=(0,r.up)("q-btn"),m=(0,r.up)("AddUser"),c=(0,r.up)("q-dialog"),p=(0,r.up)("UserCard");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",d,[(0,r.Wm)(u,{class:"q-py-sm q-my-sm",label:"Agregar personal",icon:"add",color:"blue",onClick:s[0]||(s[0]=e=>i.add=!0)}),(0,r.Wm)(c,{modelValue:i.add,"onUpdate:modelValue":s[1]||(s[1]=e=>i.add=e),persistent:""},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{onNewUser:n.addUser,ref:"newUser"},null,8,["onNewUser"])])),_:1},8,["modelValue"])]),(0,r._)("div",l,[(0,r._)("div",a,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.users,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.id,class:"col-12 col-sm-6 col-md-4 col-xl-3 q-py-xl q-px-md"},[(0,r.Wm)(p,{onEditUser:n.editUser,onRemoveUser:n.removeUser,ref_for:!0,ref:"editedUser",user:e},null,8,["onEditUser","onRemoveUser","user"])])))),128))])])],64)}var o=t(1959),n=t(5474);const u={class:"full-width row justify-between q-py-lg q-px-xl"},m={class:"col-6 col-md-11 flex"},c=(0,r._)("span",{class:"dialog__title q-my-auto q-pl-md text-h5"}," Añadir usuario ",-1),p={class:"col-6 col-md-1 flex"},h={class:"q-py-lg q-px-xl text-h6"},U=(0,r.Uk)(" Nombre(s) "),w=(0,r.Uk)(" Apellido(s) "),y=(0,r.Uk)(" Email "),q=(0,r.Uk)(" Usuario "),g=(0,r.Uk)(" Contraseña "),f=(0,r.Uk)(" Puesto "),x={class:"column content-center"};function v(e,s,t,d,l,a){const i=(0,r.up)("q-icon"),o=(0,r.up)("q-btn"),n=(0,r.up)("q-input"),v=(0,r.up)("q-select"),b=(0,r.up)("q-card-section"),_=(0,r.up)("q-card"),V=(0,r.Q2)("close-popup");return(0,r.wg)(),(0,r.j4)(_,{class:"dialog full-width column"},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{class:"q-px-xl full-width column"},{default:(0,r.w5)((()=>[(0,r._)("div",u,[(0,r._)("div",m,[(0,r.Wm)(i,{name:"account_circle",size:"300%"}),c]),(0,r._)("div",p,[(0,r.wy)((0,r.Wm)(o,{class:"q-ml-auto",size:"md",icon:"cancel",flat:"",round:""},null,512),[[V]])])]),(0,r._)("div",h,[U,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.newUser.firstName,"onUpdate:modelValue":s[0]||(s[0]=e=>l.newUser.firstName=e),type:"text"},null,8,["modelValue"]),w,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.newUser.lastName,"onUpdate:modelValue":s[1]||(s[1]=e=>l.newUser.lastName=e),type:"text"},null,8,["modelValue"]),y,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.newUser.email,"onUpdate:modelValue":s[2]||(s[2]=e=>l.newUser.email=e),type:"text"},null,8,["modelValue"]),q,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.newUser.username,"onUpdate:modelValue":s[3]||(s[3]=e=>l.newUser.username=e),type:"text"},null,8,["modelValue"]),g,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.newUser.password,"onUpdate:modelValue":s[5]||(s[5]=e=>l.newUser.password=e),type:d.isPwd?"password":"text"},{append:(0,r.w5)((()=>[(0,r.Wm)(i,{name:d.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=e=>d.isPwd=!d.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type"]),f,(0,r.Wm)(v,{outlined:"",modelValue:l.newUser.userTypeId,"onUpdate:modelValue":s[6]||(s[6]=e=>l.newUser.userTypeId=e),options:d.options,class:"q-py-md"},null,8,["modelValue","options"])]),(0,r._)("div",x,[(0,r.wy)((0,r.Wm)(o,{size:"lg",push:"",icon:"check",color:"green",label:"Confirmar",onClick:s[7]||(s[7]=e=>a.addUser())},null,512),[[V]])])])),_:1})])),_:1})}const b={name:"AddUser",data(){return{newUser:{}}},setup(){return{isPwd:(0,o.iH)(!0),options:["Admin","Trabajador Social","Punto de venta"]}},methods:{success(e){this.$q.notify({message:e,icon:"done",color:"green"})},error(e){this.$q.notify({message:e,icon:"error",color:"red"})},addUser(){"Admin"==this.newUser.userTypeId?this.newUser.userTypeId=1:"Punto de venta"==this.newUser.userTypeId?this.newUser.userTypeId=2:"Trabajador Social"==this.newUser.userTypeId&&(this.newUser.userTypeId=3);const e={username:this.newUser.username,firstName:this.newUser.firstName,lastName:this.newUser.lastName,email:this.newUser.email,password:this.newUser.password,userTypeId:this.newUser.userTypeId,image:this.newUser.image?this.newUser.image:null};n.api.post("api/user/create",e,{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.success("Usuario agregado correctamente"),this.$emit("new-user",this.newUser),this.dialog=!1})).catch((e=>{this.error("Error al agregar el usuario, inténtelo de nuevo."),401==e.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login"))}))}}};var _=t(4260),V=t(151),k=t(5589),W=t(4554),I=t(8240),T=t(4842),C=t(7637),Z=t(677),N=t(7518),Q=t.n(N);const $=(0,_.Z)(b,[["render",v]]),A=$;Q()(b,"components",{QCard:V.Z,QCardSection:k.Z,QIcon:W.Z,QBtn:I.Z,QInput:T.Z,QSelect:C.Z}),Q()(b,"directives",{ClosePopup:Z.Z});var P=t(2323),j=t(5882),E=t.n(j);const S={class:"text-red text-h4 q-px-md q-pt-md q-pb-sm"},z={class:"text-red text-h4 q-pb-md"},D={key:0,class:"text-h6 q-pa-md q-mb-md"},H={key:1,class:"text-h6 q-pa-md q-mb-md"},B={key:2,class:"text-h6 q-pa-md q-mb-md"},O={class:"content-end"};function R(e,s,t,d,l,a){const i=(0,r.up)("q-img"),o=(0,r.up)("q-avatar"),n=(0,r.up)("q-card-section"),u=(0,r.up)("q-btn"),m=(0,r.up)("q-card"),c=(0,r.up)("EditUser"),p=(0,r.up)("q-dialog");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(m,{class:"text-center",user:t.user,style:{"min-height":"100%","min-width":"250px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(n,{class:"q-pb-xl"},{default:(0,r.w5)((()=>[(0,r.Wm)(o,{size:"1250%",class:"absolute-center q-gutter-md"},{default:(0,r.w5)((()=>[t.user.image?((0,r.wg)(),(0,r.j4)(i,{key:0,src:E(),alt:"yony55",class:"rounded-img",width:"150px",loading:"lazy","spinner-color":"white"})):((0,r.wg)(),(0,r.j4)(i,{key:1,src:E(),alt:"yony55",class:"rounded-img",width:"150px",loading:"lazy","spinner-color":"white"}))])),_:1})])),_:1}),(0,r.Wm)(n,{class:"q-py-xl"},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r._)("div",S,(0,P.zw)(t.user.firstName),1),(0,r._)("div",z,(0,P.zw)(t.user.lastName),1),1==t.user.userTypeId?((0,r.wg)(),(0,r.iD)("div",D," Administrador ")):(0,r.kq)("",!0),2==t.user.userTypeId?((0,r.wg)(),(0,r.iD)("div",H," Punto de venta ")):(0,r.kq)("",!0),3==t.user.userTypeId?((0,r.wg)(),(0,r.iD)("div",B," Trabajador social ")):(0,r.kq)("",!0)]),(0,r._)("div",O,[(0,r.Wm)(u,{class:"q-mt-xl q-px-xl",icon:"edit",color:"red",label:"Editar",onClick:s[0]||(s[0]=e=>d.editCard=!0)})])])),_:1})])),_:1},8,["user"]),(0,r.Wm)(p,{modelValue:d.editCard,"onUpdate:modelValue":s[1]||(s[1]=e=>d.editCard=e),persistent:""},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{onEditUser:a.editUser,onRemoveUser:a.removeUser,ref:"editedUser",user:t.user},null,8,["onEditUser","onRemoveUser","user"])])),_:1},8,["modelValue"])],64)}const Y={class:"full-width row justify-between q-py-lg q-px-xl"},J={class:"col-6 col-md-11 flex"},G=(0,r._)("span",{class:"dialog__title q-my-auto q-pl-md text-h5"}," Editar usuario ",-1),K={class:"col-6 col-md-1 flex"},F={class:"q-py-lg q-px-xl text-h6"},L=(0,r.Uk)(" Nombre(s) "),M=(0,r.Uk)(" Apellido(s) "),X=(0,r.Uk)(" Email "),ee=(0,r.Uk)(" Usuario "),se=(0,r.Uk)(" Contraseña "),te=(0,r.Uk)(" Puesto "),re={class:"row justify-evenly"},de=(0,r._)("span",{class:"q-ml-sm text-h5"},"¿Desea eliminar este usuario?",-1);function le(e,s,t,d,l,a){const i=(0,r.up)("q-icon"),o=(0,r.up)("q-btn"),n=(0,r.up)("q-input"),u=(0,r.up)("q-select"),m=(0,r.up)("q-card-section"),c=(0,r.up)("q-card-actions"),p=(0,r.up)("q-card"),h=(0,r.up)("q-dialog"),U=(0,r.Q2)("close-popup");return(0,r.wg)(),(0,r.j4)(p,{class:"dialog column full-width"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{class:"q-px-md full-width column"},{default:(0,r.w5)((()=>[(0,r._)("div",Y,[(0,r._)("div",J,[(0,r.Wm)(i,{name:"account_circle",size:"300%"}),G]),(0,r._)("div",K,[(0,r.wy)((0,r.Wm)(o,{class:"q-ml-auto",size:"md",icon:"cancel",flat:"",round:""},null,512),[[U]])])]),(0,r._)("div",F,[L,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.editedUser.firstName,"onUpdate:modelValue":s[0]||(s[0]=e=>l.editedUser.firstName=e),type:"text"},null,8,["modelValue"]),M,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.editedUser.lastName,"onUpdate:modelValue":s[1]||(s[1]=e=>l.editedUser.lastName=e),type:"text"},null,8,["modelValue"]),X,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.editedUser.email,"onUpdate:modelValue":s[2]||(s[2]=e=>l.editedUser.email=e),type:"text"},null,8,["modelValue"]),ee,(0,r.Wm)(n,{class:"q-py-md",outlined:"",clearable:"",modelValue:l.editedUser.username,"onUpdate:modelValue":s[3]||(s[3]=e=>l.editedUser.username=e),type:"text"},null,8,["modelValue"]),se,(0,r.Wm)(n,{class:"q-py-md",outlined:"",modelValue:l.editedUser.password,"onUpdate:modelValue":s[5]||(s[5]=e=>l.editedUser.password=e),type:d.isPwd?"password":"text"},{append:(0,r.w5)((()=>[(0,r.Wm)(i,{name:d.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=e=>d.isPwd=!d.isPwd)},null,8,["name"])])),_:1},8,["modelValue","type"]),te,(0,r.Wm)(u,{outlined:"",modelValue:l.editedUser.userTypeId,"onUpdate:modelValue":s[6]||(s[6]=e=>l.editedUser.userTypeId=e),options:d.options,class:"q-py-md"},null,8,["modelValue","options"])]),(0,r._)("div",re,[(0,r.Wm)(o,{class:"q-px-md",size:"lg",push:"",icon:"delete",color:"red",label:"Eliminar",onClick:s[7]||(s[7]=e=>a.deleteUser())}),(0,r.wy)((0,r.Wm)(o,{class:"q-px-md",size:"lg",push:"",icon:"save",color:"green",label:"Guardar",onClick:s[8]||(s[8]=e=>a.editUser())},null,512),[[U]]),(0,r.Wm)(h,{modelValue:d.dialog,"onUpdate:modelValue":s[9]||(s[9]=e=>d.dialog=e),persistent:""},{default:(0,r.w5)((()=>[(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(m,{class:"row items-center"},{default:(0,r.w5)((()=>[de])),_:1}),(0,r.Wm)(c,{align:"center"},{default:(0,r.w5)((()=>[(0,r.wy)((0,r.Wm)(o,{flat:"",label:"Cancelar",color:"green"},null,512),[[U]]),(0,r.wy)((0,r.Wm)(o,{flat:"",label:"Aceptar",color:"red"},null,512),[[U,2]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1})}const ae={name:"EditUser",props:{user:Object},data(){return{editedUser:{}}},setup(){return{dialog:(0,o.iH)(!1),isPwd:(0,o.iH)(!0),model:(0,o.iH)(null),options:["Admin","Trabajador Social","Punto de venta"]}},mounted(){this.editedUser=JSON.parse(JSON.stringify(this.user)),1==this.editedUser.userTypeId?this.editedUser.userTypeId="Admin":2==this.editedUser.userTypeId?this.editedUser.userTypeId="Punto de venta":3==this.editedUser.userTypeId&&(this.editedUser.userTypeId="Trabajador Social")},methods:{success(e){this.$q.notify({message:e,icon:"done",color:"green"})},error(e){this.$q.notify({message:e,icon:"error",color:"red"})},editUser(){"Admin"==this.editedUser.userTypeId?this.editedUser.userTypeId=1:"Punto de venta"==this.editedUser.userTypeId?this.editedUser.userTypeId=2:"Trabajador Social"==this.editedUser.userTypeId&&(this.editedUser.userTypeId=3);const e={username:this.editedUser.username,firstName:this.editedUser.firstName,lastName:this.editedUser.lastName,email:this.editedUser.email,password:this.editedUser.password,userTypeId:this.editedUser.userTypeId,image:this.editedUser.image?this.editedUser.image:null};n.api.patch("api/user/"+this.editedUser.id,e,{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.success("Usuario editado correctamente"),this.$emit("edit-user",this.editedUser),this.dialog=!1})).catch((e=>{this.error("Error al editar el usuario, inténtelo de nuevo."),401==e.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login"))}))},deleteUser(){n.api["delete"]("api/user/"+this.editedUser.id,{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.$emit("remove-user",this.editedUser),this.success("Usuario eliminado"),this.dialog=!1})).catch((e=>{401==e.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login")),this.error("Error al eliminar el usuario, inténtelo de nuevo.")}))}}};var ie=t(6778),oe=t(9367);const ne=(0,_.Z)(ae,[["render",le]]),ue=ne;Q()(ae,"components",{QCard:V.Z,QCardSection:k.Z,QIcon:W.Z,QBtn:I.Z,QInput:T.Z,QSelect:C.Z,QDialog:ie.Z,QCardActions:oe.Z}),Q()(ae,"directives",{ClosePopup:Z.Z});const me={name:"UserCard",components:{EditUser:ue},props:{user:Object},setup(){return{editCard:(0,o.iH)(!1)}},methods:{editUser(e){this.$emit("edit-user",e)},removeUser(e){this.$emit("remove-user",e)}}};var ce=t(5096),pe=t(4027);const he=(0,_.Z)(me,[["render",R]]),Ue=he;Q()(me,"components",{QCard:V.Z,QCardSection:k.Z,QAvatar:ce.Z,QImg:pe.Z,QBtn:I.Z,QDialog:ie.Z});const we={name:"Staff",components:{AddUser:A,UserCard:Ue,UserCard:Ue,UserCard:Ue},data(){return{users:[]}},setup(){return{filter:(0,o.iH)(""),add:(0,o.iH)(!1)}},beforeCreate(){n.api.get("api/user",{headers:{"x-access-token":this.$store.getters.token}}).then((e=>{this.users=e.data})).catch((e=>{401==e.response.status&&(this.$store.commit("updateAuth",{auth:!1}),this.$router.push("login"))}))},methods:{addUser(e){console.log(e),this.users.splice(this.users.length,0,e)},editUser(e){let s=this.users.findIndex((s=>s.id===e.id));this.users.splice(s,1,e)},removeUser(e){let s=this.users.findIndex((s=>s.id===e.id));this.users.splice(s,1)}}},ye=(0,_.Z)(we,[["render",i]]),qe=ye;Q()(we,"components",{QBtn:I.Z,QDialog:ie.Z})},5882:(e,s,t)=>{e.exports=t.p+"img/yony55.6088b353.png"}}]);